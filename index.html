<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <label>Nome do Livro</label> <input id="nomebox" type="text"></input><br><br>
    <label>Id</label> <input id="idbox" type="text"></input><br><br>
    <label>Autor</label><input id="autorbox" type="text"></input><br><br>
    <label>Descricao</label> <input id="descbox" type="text"></input><br><br>
    <!--<label>Disponibilidade</label><input id="dispbox" type="text"></input><br><br>-->
    <br><br>
    <button id="insert">INSERT</button>
    <button id="select">SELECT</button>
    <button id="update">UPDATE</button>
    <button id="delete">DELETE</button>
    <button id="pegarL">PEGAR LIVRO</button>
    <button id="devolverL">DEVOLVER LIVRO</button>

    <script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-database.js"></script>

    <script id="MainScript">
        var firebaseConfig = {
            apiKey: "AIzaSyBDSYBfEAhVwwD8naXDEKGcD5ahJFazoA8",
            authDomain: "biblioteca-a6c29.firebaseapp.com",
            databaseURL: "https://biblioteca-a6c29.firebaseio.com",
            projectId: "biblioteca-a6c29",
            storageBucket: "biblioteca-a6c29.appspot.com",
            messagingSenderId: "603928348363",
            appId: "1:603928348363:web:f6f90187f8f98fc0823d4e"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);

        var nomeV, idV, autorV, descV, dispV;
        function Ready(){
            nomeV = document.getElementById("nomebox").value;
            idV = document.getElementById("idbox").value;
            autorV = document.getElementById("autorbox").value;
            descV = document.getElementById("descbox").value;
            //dispV = document.getElementById("dispbox").value;
        }

        ///insert
        document.getElementById('insert').onclick = function(){
            Ready();

            firebase.database().ref('livro/' + idV).set({
                nomeDoLivro: nomeV,
                id: idV,
                autor: autorV,
                descricao: descV,
                disponibilidade: 'disponivel'
            });
            alert('Livro Cadastrado')
        }

        //select
        document.getElementById("select").onclick = function(){
            Ready();
            firebase.database().ref("livro/"+idV).on('value', function(snapshot){
                document.getElementById("nomebox").value = snapshot.val().nomeDoLivro;
                document.getElementById("autorbox").value = snapshot.val().autor;
                document.getElementById("descbox").value = snapshot.val().descricao;
                //document.getElementById("dispbox").value = snapshot.val().disponibilidade;
            });
        }

        //update
        document.getElementById('update').onclick = function(){
            Ready();
            firebase.database().ref('livro/' + idV).update({
                nomeDoLivro: nomeV,
                id: idV,
                autor: autorV,
                descricao: descV,
                //disponibilidade: dispV
            });
            alert('Dados do Livro Atualizados')
        }

        //delete
        document.getElementById('delete').onclick = function(){
            Ready();
            firebase.database().ref('livro/' + idV).remove();
            alert('Livro removido')
        }

        //pegar livro
        document.getElementById("pegarL").onclick = function(){
            Ready();
            var verifica
            firebase.database().ref("livro/"+idV).on('value', function(snapshot){
                verifica = snapshot.val().disponibilidade;
            });
            if (verifica != 'disponivel'){
                alert('Livro Ocupado');
            }else{
                alert('Livro Pego')
                firebase.database().ref('livro/' + idV).update({
                disponibilidade: 'ocupado'
                });
            }
        }

        //devolverlivro
        document.getElementById("devolverL").onclick = function(){
            Ready();
            var verifica
            firebase.database().ref("livro/"+idV).on('value', function(snapshot){
                verifica = snapshot.val().disponibilidade;
            });
            if (verifica == 'ocupado'){
                alert('Livro Devolvido');
                firebase.database().ref('livro/' + idV).update({
                    disponibilidade: 'disponivel'
                });
            }else{
                alert('Não há o que devolver, o livro está disponível')
            }
    }
    </script>
    <script>
         
    </script>

</body>
</html>